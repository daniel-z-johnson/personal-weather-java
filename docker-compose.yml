services:

  redis:
    image: redis:8.2-alpine
    container_name: redis
    ports:
      - "6380:6379"
    restart: unless-stopped

  postgres:
    image: postgres:17.6
    container_name: postgres
    environment:
      POSTGRES_USER: weather
      POSTGRES_PASSWORD: postgress
      POSTGRES_DB: weather
    ports:
      - "5432:5432"
        #volumes:
        #- postgres_data:/var/lib/postgresql/data
    restart: unless-stopped


  postgres_sonar:
    image: postgres:17.6
    container_name: postgres_sonar
    environment:
      POSTGRES_USER: sonar
      POSTGRES_PASSWORD: sonar
      POSTGRES_DB: sonar
    ports:
      - "5433:5432"
        #volumes:
        #- postgres_data_sonar:/var/lib/postgresql/data
    restart: unless-stopped

  sonarqube:
    image: sonarqube:community
    container_name: sonarqube
    depends_on:
      - postgres_sonar
    environment:
      SONAR_JDBC_URL: jdbc:postgresql://postgres_sonar:5432/sonar
      SONAR_JDBC_USERNAME: sonar
      SONAR_JDBC_PASSWORD: sonar
    ports:
      - "9000:9000"
        #volumes:
        #- sonarqube_data:/opt/sonarqube/data
        #- sonarqube_extensions:/opt/sonarqube/extensions
    restart: unless-stopped
  
  jenkins:
    image: jenkins/jenkins:lts
    container_name: jenkins
    ports:
      - "7777:8080"
      - "50000:50000"
    restart: unless-stopped
      # gitlab:
      #image: gitlab/gitlab-ce:latest
      # restart: always
      #hostname: 'localhost'
      #environment:
      #GITLAB_OMNIBUS_CONFIG:
      #  external_url 'http://localhost:8929'
      #ports:
      #- '8929:80'
      #- '2224:22'


      #volumes:
      #postgres_data:
      #postgres_data_sonar:
      #sonarqube_data:
      #sonarqube_extensions:
